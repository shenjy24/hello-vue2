{"version":3,"file":"js/940.62488cec.js","mappings":"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","sources":["webpack://jackal-vue2-new/./node_modules/idb-managed/build/db_wrapper.js","webpack://jackal-vue2-new/./node_modules/idb-managed/build/index.js","webpack://jackal-vue2-new/./node_modules/idb-managed/build/lib/db_env_checker.js","webpack://jackal-vue2-new/./node_modules/idb-managed/build/lib/idb.js","webpack://jackal-vue2-new/./node_modules/idb-managed/build/lib/utils.js","webpack://jackal-vue2-new/./node_modules/logan-web/build/lib/logan-db.js","webpack://jackal-vue2-new/./node_modules/logan-web/build/logan-operation-queue.js"],"sourcesContent":["\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * @file Wrap idb APIs for idb-managed\n */\nvar utils_1 = require(\"./lib/utils\");\nvar IDB = require('./lib/idb');\nvar IDB_MANAGER_VERSION = 1;\nvar IDB_MANAGER_DB_NAME = 'IDB_MANAGER_DB';\nvar IDB_MANAGER_DB_TABLE_NAME = 'IDB_MANAGER_STORE';\nvar IDB_MANAGER_DB_TABLE_INDEX_NAME = 'dbName';\nvar UPDATETIME_KEYNAME = 'updateTime';\nvar EXPIRETIME_KEYNAME = 'expireTime';\nfunction indexRange2DBKey(indexRange) {\n    var onlyIndex = indexRange.onlyIndex, lowerIndex = indexRange.lowerIndex, upperIndex = indexRange.upperIndex, _a = indexRange.lowerExclusive, lowerExclusive = _a === void 0 ? false : _a, _b = indexRange.upperExclusive, upperExclusive = _b === void 0 ? false : _b;\n    if (onlyIndex !== undefined) {\n        return IDBKeyRange.only(onlyIndex);\n    }\n    else if (lowerIndex !== undefined && upperIndex !== undefined) {\n        return IDBKeyRange.bound(lowerIndex, upperIndex, lowerExclusive, upperExclusive);\n    }\n    else if (lowerIndex !== undefined) {\n        return IDBKeyRange.lowerBound(lowerIndex, lowerExclusive);\n    }\n    else {\n        return IDBKeyRange.upperBound(upperIndex, upperExclusive);\n    }\n}\nfunction itemWrapper(itemConfig) {\n    var _a;\n    var currentTime = Date.now();\n    return __assign(__assign({}, itemConfig.item), (_a = {}, _a[UPDATETIME_KEYNAME] = currentTime, _a[EXPIRETIME_KEYNAME] = itemConfig.itemDuration !== undefined\n        ? itemConfig.itemDuration + currentTime\n        : -1, _a));\n}\nfunction itemUnwrapper(item) {\n    if (!item) {\n        return null;\n    }\n    else if (item.expireTime > 0 && item.expireTime < Date.now()) {\n        return null;\n    }\n    else {\n        delete item.updateTime;\n        delete item.expireTime;\n        return item;\n    }\n}\nfunction registerDBInManager(dbInfo) {\n    return __awaiter(this, void 0, void 0, function () {\n        var dbManager, dbAlreadyInManager, addDBTrans, table, dbItem;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4 /*yield*/, openDBManager()];\n                case 1:\n                    dbManager = _a.sent();\n                    return [4 /*yield*/, getItemFromDB(dbManager, IDB_MANAGER_DB_TABLE_NAME, dbInfo.name)];\n                case 2:\n                    dbAlreadyInManager = (_a.sent());\n                    if (!(!dbAlreadyInManager || dbInfo.version > dbAlreadyInManager.version)) return [3 /*break*/, 4];\n                    addDBTrans = dbManager.transaction(IDB_MANAGER_DB_TABLE_NAME, 'readwrite');\n                    table = addDBTrans.objectStore(IDB_MANAGER_DB_TABLE_NAME);\n                    dbItem = {\n                        dbName: dbInfo.name,\n                        tableList: dbInfo.tableList,\n                        version: dbInfo.version\n                    };\n                    table.put(itemWrapper({\n                        item: dbItem,\n                        tableName: IDB_MANAGER_DB_TABLE_NAME\n                    }));\n                    return [4 /*yield*/, addDBTrans.complete];\n                case 3:\n                    _a.sent();\n                    dbManager.close();\n                    _a.label = 4;\n                case 4: return [2 /*return*/];\n            }\n        });\n    });\n}\nfunction unregisterDBInManager(dbName) {\n    return __awaiter(this, void 0, void 0, function () {\n        var dbManager, deleteTrans, table;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4 /*yield*/, openDBManager()];\n                case 1:\n                    dbManager = _a.sent();\n                    deleteTrans = dbManager.transaction(IDB_MANAGER_DB_TABLE_NAME, 'readwrite');\n                    table = deleteTrans.objectStore(IDB_MANAGER_DB_TABLE_NAME);\n                    table.delete(dbName);\n                    return [4 /*yield*/, deleteTrans.complete];\n                case 2:\n                    _a.sent();\n                    dbManager.close();\n                    return [2 /*return*/];\n            }\n        });\n    });\n}\nfunction createDB(dbInfo) {\n    return __awaiter(this, void 0, void 0, function () {\n        var db;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4 /*yield*/, registerDBInManager(dbInfo)];\n                case 1:\n                    _a.sent();\n                    return [4 /*yield*/, IDB.open(dbInfo.name, dbInfo.version, function (upgradeDB) {\n                            upgradeDBWithTableList(upgradeDB, dbInfo.tableList);\n                        })];\n                case 2:\n                    db = _a.sent();\n                    return [2 /*return*/, db];\n            }\n        });\n    });\n}\nfunction openDBManager() {\n    return __awaiter(this, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4 /*yield*/, IDB.open(IDB_MANAGER_DB_NAME, IDB_MANAGER_VERSION, \n                    // In case DB Manager has not been created.\n                    function (upgradeDB) {\n                        upgradeDBManager(upgradeDB);\n                    })];\n                case 1: return [2 /*return*/, _a.sent()];\n            }\n        });\n    });\n}\nfunction openDB(dbName) {\n    return __awaiter(this, void 0, void 0, function () {\n        var dbManager, dbAlreadyInManager, db;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4 /*yield*/, openDBManager()];\n                case 1:\n                    dbManager = _a.sent();\n                    return [4 /*yield*/, getItemFromDB(dbManager, IDB_MANAGER_DB_TABLE_NAME, dbName)];\n                case 2:\n                    dbAlreadyInManager = (_a.sent());\n                    dbManager.close();\n                    if (!dbAlreadyInManager) return [3 /*break*/, 4];\n                    return [4 /*yield*/, IDB.open(dbAlreadyInManager.dbName, dbAlreadyInManager.version, \n                        // In case this DB has not been created.\n                        function (upgradeDB) {\n                            upgradeDBWithTableList(upgradeDB, dbAlreadyInManager.tableList || []);\n                        })];\n                case 3:\n                    db = _a.sent();\n                    return [2 /*return*/, db];\n                case 4: return [2 /*return*/, null];\n            }\n        });\n    });\n}\nfunction getItemFromDB(db, tableName, primaryKeyValue) {\n    return __awaiter(this, void 0, void 0, function () {\n        var trans, table, itemInTable, e_1;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    if (!db.objectStoreNames.contains(tableName)) return [3 /*break*/, 8];\n                    trans = db.transaction(tableName, 'readonly');\n                    _a.label = 1;\n                case 1:\n                    _a.trys.push([1, , 3, 7]);\n                    table = trans.objectStore(tableName);\n                    return [4 /*yield*/, table.get(primaryKeyValue)];\n                case 2:\n                    itemInTable = (_a.sent());\n                    return [2 /*return*/, itemUnwrapper(itemInTable)];\n                case 3:\n                    _a.trys.push([3, 5, , 6]);\n                    return [4 /*yield*/, trans.complete];\n                case 4:\n                    _a.sent();\n                    return [3 /*break*/, 6];\n                case 5:\n                    e_1 = _a.sent();\n                    return [3 /*break*/, 6];\n                case 6: return [7 /*endfinally*/];\n                case 7: return [3 /*break*/, 9];\n                case 8: return [2 /*return*/, null];\n                case 9: return [2 /*return*/];\n            }\n        });\n    });\n}\nfunction upgradeDBManager(upgradeDB) {\n    upgradeDB.createObjectStore(IDB_MANAGER_DB_TABLE_NAME, {\n        keyPath: IDB_MANAGER_DB_TABLE_INDEX_NAME\n    });\n}\nfunction upgradeDBWithTableList(upgradeDB, tableList) {\n    try {\n        tableList.forEach(function (tableConfig) {\n            // If table already exists.\n            if (upgradeDB.objectStoreNames.contains(tableConfig.tableName)) {\n                var currentTable_1 = upgradeDB\n                    .transaction(tableConfig.tableName)\n                    .objectStore(tableConfig.tableName);\n                // Create new index for present table.\n                (tableConfig.indexList || []).forEach(function (theIndex) {\n                    if (!currentTable_1.indexNames.contains(theIndex.indexName)) {\n                        currentTable_1.createIndex(theIndex.indexName, theIndex.indexName, { unique: theIndex.unique });\n                    }\n                });\n                // Else create new table.\n            }\n            else {\n                var tablePrimaryKey = tableConfig.primaryKey || 'id';\n                var tableToCreate_1 = upgradeDB.createObjectStore(tableConfig.tableName, __assign({ keyPath: tablePrimaryKey }, (tablePrimaryKey === 'id'\n                    ? { autoIncrement: true }\n                    : {})));\n                // Set index of primaryKey.\n                tableToCreate_1.createIndex(tablePrimaryKey, tablePrimaryKey, {\n                    unique: true\n                });\n                // Set indexes defined in tableConfig\n                (tableConfig.indexList || []).forEach(function (theIndex) {\n                    tableToCreate_1.createIndex(theIndex.indexName, theIndex.indexName, { unique: theIndex.unique });\n                });\n                // Set index of updateTime for data ordering priority.\n                tableToCreate_1.createIndex(UPDATETIME_KEYNAME, UPDATETIME_KEYNAME, { unique: false });\n                // Set index of expireTime for expired data deletion.\n                tableToCreate_1.createIndex(EXPIRETIME_KEYNAME, EXPIRETIME_KEYNAME, { unique: false });\n            }\n        });\n    }\n    catch (e) {\n        upgradeDB.close(); // Close upgraded DB to trigger the failure of this opening process.\n    }\n}\nfunction atomicTrans(transaction, db, tryStatement) {\n    return __awaiter(this, void 0, void 0, function () {\n        var transError_1, e_2;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    _a.trys.push([0, 3, 8, 9]);\n                    return [4 /*yield*/, tryStatement()];\n                case 1:\n                    _a.sent();\n                    return [4 /*yield*/, transaction.complete];\n                case 2:\n                    _a.sent();\n                    return [3 /*break*/, 9];\n                case 3:\n                    transError_1 = _a.sent();\n                    try {\n                        // To roll back all operations in this transaction if any error happens.\n                        transaction.abort();\n                    }\n                    catch (e) {\n                        // Do nothing if transaction abort failed.\n                    }\n                    _a.label = 4;\n                case 4:\n                    _a.trys.push([4, 6, , 7]);\n                    // To catch the Promise error caused by transaction abortion. Otherwise, uncaught rejection will be thrown up.\n                    return [4 /*yield*/, transaction.complete];\n                case 5:\n                    // To catch the Promise error caused by transaction abortion. Otherwise, uncaught rejection will be thrown up.\n                    _a.sent();\n                    return [3 /*break*/, 7];\n                case 6:\n                    e_2 = _a.sent();\n                    return [3 /*break*/, 7];\n                case 7: \n                // Throw specific error happened in tryStatement.\n                throw transError_1;\n                case 8:\n                    db.close();\n                    return [7 /*endfinally*/];\n                case 9: return [2 /*return*/];\n            }\n        });\n    });\n}\nfunction deleteItemsFromDB(db, tableIndexRanges) {\n    return __awaiter(this, void 0, void 0, function () {\n        var validRanges, dedupTableNameList, deleteItemsTrans;\n        var _this = this;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    validRanges = tableIndexRanges.filter(function (indexRange) {\n                        return db.objectStoreNames.contains(indexRange.tableName);\n                    });\n                    dedupTableNameList = utils_1.deduplicateList(validRanges.map(function (tableIndexRange) { return tableIndexRange.tableName; }));\n                    deleteItemsTrans = db.transaction(dedupTableNameList, 'readwrite');\n                    return [4 /*yield*/, atomicTrans(deleteItemsTrans, db, function () { return __awaiter(_this, void 0, void 0, function () {\n                            return __generator(this, function (_a) {\n                                switch (_a.label) {\n                                    case 0: return [4 /*yield*/, Promise.all(validRanges.map(function (tableIndexRange) {\n                                            var tableName = tableIndexRange.tableName, indexRange = tableIndexRange.indexRange;\n                                            var table = deleteItemsTrans.objectStore(tableName);\n                                            if (!indexRange) {\n                                                return table.clear();\n                                            }\n                                            else {\n                                                return new Promise(function (resolve) {\n                                                    table.index(indexRange.indexName).iterateCursor(indexRange2DBKey(indexRange), function (cursor) {\n                                                        if (!cursor) {\n                                                            resolve();\n                                                            return;\n                                                        }\n                                                        table.delete(cursor.primaryKey);\n                                                        cursor.continue();\n                                                    });\n                                                });\n                                            }\n                                        }))];\n                                    case 1:\n                                        _a.sent();\n                                        return [2 /*return*/];\n                                }\n                            });\n                        }); })];\n                case 1:\n                    _a.sent();\n                    return [2 /*return*/];\n            }\n        });\n    });\n}\nfunction addItems(dbInfo, items) {\n    return __awaiter(this, void 0, void 0, function () {\n        var dedupTableNameList, db, addItemsTrans;\n        var _this = this;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    dedupTableNameList = utils_1.deduplicateList(items.map(function (item) { return item.tableName; }));\n                    return [4 /*yield*/, deleteItems(dbInfo.name, dedupTableNameList.map(function (tableName) {\n                            return {\n                                tableName: tableName,\n                                indexRange: {\n                                    indexName: EXPIRETIME_KEYNAME,\n                                    upperIndex: +new Date(),\n                                    upperExclusive: false\n                                }\n                            };\n                        }))];\n                case 1:\n                    _a.sent();\n                    return [4 /*yield*/, createDB(dbInfo)];\n                case 2:\n                    db = _a.sent();\n                    addItemsTrans = db.transaction(dedupTableNameList, 'readwrite');\n                    return [4 /*yield*/, atomicTrans(addItemsTrans, db, function () { return __awaiter(_this, void 0, void 0, function () {\n                            return __generator(this, function (_a) {\n                                switch (_a.label) {\n                                    case 0: return [4 /*yield*/, Promise.all(items.map(function (item) { return addItemsTrans.objectStore(item.tableName).put(itemWrapper(item)); }))];\n                                    case 1:\n                                        _a.sent();\n                                        return [2 /*return*/];\n                                }\n                            });\n                        }); })];\n                case 3:\n                    _a.sent();\n                    return [2 /*return*/];\n            }\n        });\n    });\n}\nexports.addItems = addItems;\nfunction getItem(dbName, tableName, primaryKeyValue) {\n    return __awaiter(this, void 0, void 0, function () {\n        var db, item, e_3;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4 /*yield*/, openDB(dbName)];\n                case 1:\n                    db = _a.sent();\n                    if (!db) return [3 /*break*/, 7];\n                    _a.label = 2;\n                case 2:\n                    _a.trys.push([2, 4, 5, 6]);\n                    return [4 /*yield*/, getItemFromDB(db, tableName, primaryKeyValue)];\n                case 3:\n                    item = _a.sent();\n                    return [2 /*return*/, item];\n                case 4:\n                    e_3 = _a.sent();\n                    throw e_3;\n                case 5:\n                    db.close();\n                    return [7 /*endfinally*/];\n                case 6: return [3 /*break*/, 8];\n                case 7: return [2 /*return*/, null];\n                case 8: return [2 /*return*/];\n            }\n        });\n    });\n}\nexports.getItem = getItem;\nfunction getItemsInRange(dbName, tableIndexRange) {\n    return __awaiter(this, void 0, void 0, function () {\n        var tableName, indexRange, db, items_1, trans, table_1, wrappedItems, e_4, e_5;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    tableName = tableIndexRange.tableName, indexRange = tableIndexRange.indexRange;\n                    return [4 /*yield*/, openDB(dbName)];\n                case 1:\n                    db = _a.sent();\n                    if (!db) return [3 /*break*/, 17];\n                    _a.label = 2;\n                case 2:\n                    _a.trys.push([2, 14, 15, 16]);\n                    items_1 = [];\n                    if (!!db.objectStoreNames.contains(tableName)) return [3 /*break*/, 3];\n                    return [3 /*break*/, 13];\n                case 3:\n                    trans = db.transaction(tableName, 'readonly');\n                    _a.label = 4;\n                case 4:\n                    _a.trys.push([4, , 9, 13]);\n                    table_1 = trans.objectStore(tableName);\n                    if (!!indexRange) return [3 /*break*/, 6];\n                    return [4 /*yield*/, table_1.getAll()];\n                case 5:\n                    wrappedItems = _a.sent();\n                    items_1 = (wrappedItems || [])\n                        .map(itemUnwrapper)\n                        .filter(function (item) {\n                        return item !== null;\n                    });\n                    return [3 /*break*/, 8];\n                case 6: return [4 /*yield*/, new Promise(function (resolve) {\n                        table_1.index(indexRange.indexName).iterateCursor(indexRange2DBKey(indexRange), function (cursor) {\n                            if (!cursor) {\n                                resolve();\n                                return;\n                            }\n                            var item = itemUnwrapper(cursor.value);\n                            item && items_1.push(item);\n                            cursor.continue();\n                        });\n                    })];\n                case 7:\n                    _a.sent();\n                    _a.label = 8;\n                case 8: return [3 /*break*/, 13];\n                case 9:\n                    _a.trys.push([9, 11, , 12]);\n                    return [4 /*yield*/, trans.complete];\n                case 10:\n                    _a.sent();\n                    return [3 /*break*/, 12];\n                case 11:\n                    e_4 = _a.sent();\n                    return [3 /*break*/, 12];\n                case 12: return [7 /*endfinally*/];\n                case 13: return [2 /*return*/, items_1];\n                case 14:\n                    e_5 = _a.sent();\n                    throw e_5;\n                case 15:\n                    db.close();\n                    return [7 /*endfinally*/];\n                case 16: return [3 /*break*/, 18];\n                case 17: return [2 /*return*/, []];\n                case 18: return [2 /*return*/];\n            }\n        });\n    });\n}\nexports.getItemsInRange = getItemsInRange;\nfunction deleteDB(dbName) {\n    return __awaiter(this, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4 /*yield*/, unregisterDBInManager(dbName)];\n                case 1:\n                    _a.sent();\n                    return [4 /*yield*/, IDB.delete(dbName)];\n                case 2:\n                    _a.sent();\n                    return [2 /*return*/];\n            }\n        });\n    });\n}\nexports.deleteDB = deleteDB;\nfunction deleteItems(dbName, tableIndexRanges) {\n    return __awaiter(this, void 0, void 0, function () {\n        var db;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4 /*yield*/, openDB(dbName)];\n                case 1:\n                    db = _a.sent();\n                    if (!db) return [3 /*break*/, 3];\n                    return [4 /*yield*/, deleteItemsFromDB(db, tableIndexRanges)];\n                case 2:\n                    _a.sent();\n                    return [3 /*break*/, 4];\n                case 3: \n                // If db does not exist, no need to deleteItems at all.\n                return [2 /*return*/];\n                case 4: return [2 /*return*/];\n            }\n        });\n    });\n}\nexports.deleteItems = deleteItems;\nexports.default = {\n    addItems: addItems,\n    getItem: getItem,\n    getItemsInRange: getItemsInRange,\n    deleteDB: deleteDB,\n    deleteItems: deleteItems\n};\n","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar db_env_checker_1 = require(\"./lib/db_env_checker\");\nvar db_wrapper_1 = require(\"./db_wrapper\");\nvar utils_1 = require(\"./lib/utils\");\nvar DEFAULT_DB_VERSION = 1;\nvar OPTIONAL = true;\nfunction customDBConfigChecker(dbConfig) {\n    utils_1.paramChecker(dbConfig, utils_1.ParamCheckerEnum.NotNullObject, 'dbConfig', !OPTIONAL);\n    utils_1.paramChecker(dbConfig.dbName, utils_1.ParamCheckerEnum.String, 'dbName', !OPTIONAL);\n    utils_1.paramChecker(dbConfig.dbVersion, utils_1.ParamCheckerEnum.NonNegativeInteger, 'dbVersion', OPTIONAL);\n    utils_1.paramChecker(dbConfig.itemDuration, utils_1.ParamCheckerEnum.NonNegativeInteger, 'itemDuration of dbConfig', OPTIONAL);\n    utils_1.paramChecker(dbConfig.tables, utils_1.ParamCheckerEnum.NotNullObject, 'tables', OPTIONAL);\n    Object.keys(dbConfig.tables || {}).forEach(function (tableName) {\n        var tableConfig = dbConfig.tables[tableName];\n        utils_1.paramChecker(tableConfig.primaryKey, utils_1.ParamCheckerEnum.String, 'primaryKey', OPTIONAL);\n        utils_1.paramChecker(tableConfig.itemDuration, utils_1.ParamCheckerEnum.NonNegativeInteger, 'itemDuration of table', OPTIONAL);\n        utils_1.paramChecker(tableConfig.indexList, utils_1.ParamCheckerEnum.Array, 'indexList', OPTIONAL);\n        (tableConfig.indexList || []).forEach(function (index) {\n            utils_1.paramChecker(index.indexName, utils_1.ParamCheckerEnum.String, 'indexName', !OPTIONAL);\n            utils_1.paramChecker(index.unique, utils_1.ParamCheckerEnum.Boolean, 'unique', OPTIONAL);\n        });\n    });\n}\nfunction customDBAddItemsParamChecker(items, tableListInDB) {\n    utils_1.paramChecker(items, utils_1.ParamCheckerEnum.Array, 'items', !OPTIONAL);\n    items.forEach(function (itemOfTable) {\n        utils_1.paramChecker(itemOfTable.tableName, utils_1.ParamCheckerEnum.String, \"item's tableName\", !OPTIONAL);\n        utils_1.paramChecker(itemOfTable.itemDuration, utils_1.ParamCheckerEnum.NonNegativeInteger, \"item's itemDuration\", OPTIONAL);\n        var theTable = tableListInDB.filter(function (table) { return table.tableName === itemOfTable.tableName; })[0];\n        if (!theTable) {\n            throw new Error(\"Table \" + itemOfTable.tableName + \" does not exist\");\n        }\n        else if (theTable.primaryKey !== undefined &&\n            Object.getOwnPropertyNames(itemOfTable.item).indexOf(theTable.primaryKey) < 0) {\n            throw new Error(\"primaryKey is needed for item in table \" + itemOfTable.tableName);\n        }\n    });\n}\nfunction tableIndexRangeParamChecker(tableIndexRange) {\n    utils_1.paramChecker(tableIndexRange, utils_1.ParamCheckerEnum.NotNullObject, 'tableIndexRange', !OPTIONAL);\n    utils_1.paramChecker(tableIndexRange.tableName, utils_1.ParamCheckerEnum.String, \"tableIndexRange's\", !OPTIONAL);\n    utils_1.paramChecker(tableIndexRange.indexRange, utils_1.ParamCheckerEnum.NotNullObject, \"tableIndexRange's indexRange\", OPTIONAL);\n    if (tableIndexRange.indexRange) {\n        var _a = tableIndexRange.indexRange, indexName = _a.indexName, onlyIndex = _a.onlyIndex, lowerIndex = _a.lowerIndex, upperIndex = _a.upperIndex, lowerExclusive = _a.lowerExclusive, upperExclusive = _a.upperExclusive;\n        utils_1.paramChecker(indexName, utils_1.ParamCheckerEnum.String, \"indexRange's indexName\", !OPTIONAL);\n        if (onlyIndex === undefined && lowerIndex === undefined && upperIndex === undefined) {\n            throw new Error('indexRange should have bounds or value for the index');\n        }\n        else if (lowerIndex !== undefined && upperIndex !== undefined && lowerIndex >= upperIndex) {\n            throw new Error('lowerIndex should be less than upperIndex');\n        }\n        if (lowerIndex && upperIndex)\n            utils_1.paramChecker(lowerExclusive, utils_1.ParamCheckerEnum.Boolean, \"indexRange's lowerExclusive\", OPTIONAL);\n        utils_1.paramChecker(upperExclusive, utils_1.ParamCheckerEnum.Boolean, \"indexRange's upperExclusive\", OPTIONAL);\n    }\n}\nfunction idbIsSupported() {\n    try {\n        db_env_checker_1.default();\n        return true;\n    }\n    catch (e) {\n        return false;\n    }\n}\nexports.idbIsSupported = idbIsSupported;\nvar CustomDB = /** @class */ (function () {\n    function CustomDB(dbConfig) {\n        db_env_checker_1.default();\n        customDBConfigChecker(dbConfig);\n        this.name = dbConfig.dbName;\n        this.version = utils_1.optionWithBackup(dbConfig.dbVersion, DEFAULT_DB_VERSION);\n        this.tableList = Object.keys(dbConfig.tables || {}).map(function (tableName) {\n            return __assign({ tableName: tableName }, dbConfig.tables[tableName]);\n        });\n        this.itemDuration = dbConfig.itemDuration;\n    }\n    CustomDB.prototype.addItems = function (itemConfigs) {\n        return __awaiter(this, void 0, void 0, function () {\n            var itemDurationOverrider, itemsWithDuration;\n            var _this = this;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        itemDurationOverrider = function (ofDB, ofTable, ofItem) {\n                            if (ofItem !== undefined) {\n                                return ofItem;\n                            }\n                            else if (ofTable !== undefined) {\n                                return ofTable;\n                            }\n                            else {\n                                return ofDB;\n                            }\n                        };\n                        customDBAddItemsParamChecker(itemConfigs, this.tableList);\n                        itemsWithDuration = itemConfigs.map(function (itemConfig) {\n                            var theTable = _this.tableList.filter(function (table) { return table.tableName === itemConfig.tableName; })[0];\n                            return __assign({ itemDuration: itemDurationOverrider(_this.itemDuration, theTable.itemDuration, itemConfig.itemDuration) }, itemConfig);\n                        });\n                        return [4 /*yield*/, db_wrapper_1.default.addItems({\n                                name: this.name,\n                                tableList: this.tableList,\n                                version: this.version\n                            }, itemsWithDuration)];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    CustomDB.prototype.getItem = function (tableName, primaryKeyValue) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, getItemFromDB(this.name, tableName, primaryKeyValue)];\n                    case 1: return [2 /*return*/, _a.sent()];\n                }\n            });\n        });\n    };\n    CustomDB.prototype.getItemsInRange = function (tableIndexRange) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, getItemsInRangeFromDB(this.name, tableIndexRange)];\n                    case 1: return [2 /*return*/, _a.sent()];\n                }\n            });\n        });\n    };\n    CustomDB.prototype.deleteItemsInRange = function (tableIndexRanges) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        utils_1.paramChecker(tableIndexRanges, utils_1.ParamCheckerEnum.Array, 'tableIndexRanges', !OPTIONAL);\n                        tableIndexRanges.forEach(function (tableIndexRange) {\n                            tableIndexRangeParamChecker(tableIndexRange);\n                        });\n                        return [4 /*yield*/, db_wrapper_1.default.deleteItems(this.name, tableIndexRanges)];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    return CustomDB;\n}());\nexports.CustomDB = CustomDB;\nfunction deleteDB(dbName) {\n    return __awaiter(this, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    db_env_checker_1.default();\n                    utils_1.paramChecker(dbName, utils_1.ParamCheckerEnum.String, 'dbName', !OPTIONAL);\n                    return [4 /*yield*/, db_wrapper_1.default.deleteDB(dbName)];\n                case 1:\n                    _a.sent();\n                    return [2 /*return*/];\n            }\n        });\n    });\n}\nexports.deleteDB = deleteDB;\nfunction getItemFromDB(dbName, tableName, primaryKeyValue) {\n    return __awaiter(this, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    utils_1.paramChecker(dbName, utils_1.ParamCheckerEnum.String, 'dbName', !OPTIONAL);\n                    utils_1.paramChecker(tableName, utils_1.ParamCheckerEnum.String, 'tableName', !OPTIONAL);\n                    return [4 /*yield*/, db_wrapper_1.default.getItem(dbName, tableName, primaryKeyValue)];\n                case 1: return [2 /*return*/, _a.sent()];\n            }\n        });\n    });\n}\nexports.getItemFromDB = getItemFromDB;\nfunction getItemsInRangeFromDB(dbName, tableIndexRange) {\n    return __awaiter(this, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    utils_1.paramChecker(dbName, utils_1.ParamCheckerEnum.String, 'dbName', !OPTIONAL);\n                    tableIndexRangeParamChecker(tableIndexRange);\n                    return [4 /*yield*/, db_wrapper_1.default.getItemsInRange(dbName, tableIndexRange)];\n                case 1: return [2 /*return*/, _a.sent()];\n            }\n        });\n    });\n}\nexports.getItemsInRangeFromDB = getItemsInRangeFromDB;\nexports.default = {\n    idbIsSupported: idbIsSupported,\n    CustomDB: CustomDB,\n    deleteDB: deleteDB,\n    getItemFromDB: getItemFromDB,\n    getItemsInRangeFromDB: getItemsInRangeFromDB\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * @file IndexedDB compatibility checker\n */\nfunction default_1() {\n    if (!window) {\n        throw new Error('idb-managed can not run in non-browser environment');\n    }\n    for (var _i = 0, _a = [\n        'indexedDB',\n        'IDBDatabase',\n        'IDBObjectStore',\n        'IDBTransaction',\n        'IDBIndex',\n        'IDBCursor',\n        'IDBKeyRange',\n        'IDBRequest'\n    ]; _i < _a.length; _i++) {\n        var property = _a[_i];\n        // @ts-ignore\n        if (!window.hasOwnProperty(property) || !window[property]) {\n            throw new Error(property + \" is not supported in window\");\n        }\n    }\n}\nexports.default = default_1;\n","/**\n * @file Codes in this file are based on https://raw.githubusercontent.com/jakearchibald/idb/v2.1.3/lib/idb.js, modified to check whether some db properties exist before proxy methods execute.\n */\n\nfunction toArray(arr) {\n    return Array.prototype.slice.call(arr);\n}\n\nfunction promisifyRequest(request) {\n    return new Promise(function(resolve, reject) {\n        request.onsuccess = function() {\n            resolve(request.result);\n        };\n\n        request.onerror = function() {\n            reject(request.error);\n        };\n    });\n}\n\nfunction promisifyRequestCall(obj, method, args) {\n    var request;\n    var p = new Promise(function(resolve, reject) {\n        request = obj[method].apply(obj, args);\n        promisifyRequest(request).then(resolve, reject);\n    });\n\n    p.request = request;\n    return p;\n}\n\nfunction promisifyCursorRequestCall(obj, method, args) {\n    var p = promisifyRequestCall(obj, method, args);\n    return p.then(function(value) {\n        if (!value) return;\n        return new Cursor(value, p.request);\n    });\n}\n\nfunction proxyProperties(ProxyClass, targetProp, properties) {\n    properties.forEach(function(prop) {\n        Object.defineProperty(ProxyClass.prototype, prop, {\n            get: function() {\n                return this[targetProp][prop];\n            },\n            set: function(val) {\n                this[targetProp][prop] = val;\n            }\n        });\n    });\n}\n\nfunction proxyRequestMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n        if (!(prop in Constructor.prototype)) return;\n        ProxyClass.prototype[prop] = function() {\n            return promisifyRequestCall(this[targetProp], prop, arguments);\n        };\n    });\n}\n\nfunction proxyMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n        if (!(prop in Constructor.prototype)) return;\n        ProxyClass.prototype[prop] = function() {\n            return this[targetProp][prop].apply(this[targetProp], arguments);\n        };\n    });\n}\n\nfunction proxyCursorRequestMethods(\n    ProxyClass,\n    targetProp,\n    Constructor,\n    properties\n) {\n    properties.forEach(function(prop) {\n        if (!(prop in Constructor.prototype)) return;\n        ProxyClass.prototype[prop] = function() {\n            return promisifyCursorRequestCall(\n                this[targetProp],\n                prop,\n                arguments\n            );\n        };\n    });\n}\n\nfunction Index(index) {\n    this._index = index;\n}\n\nfunction Cursor(cursor, request) {\n    this._cursor = cursor;\n    this._request = request;\n}\n\nfunction ObjectStore(store) {\n    this._store = store;\n}\n\nObjectStore.prototype.createIndex = function() {\n    return new Index(this._store.createIndex.apply(this._store, arguments));\n};\n\nObjectStore.prototype.index = function() {\n    return new Index(this._store.index.apply(this._store, arguments));\n};\n\nfunction Transaction(idbTransaction) {\n    this._tx = idbTransaction;\n    this.complete = new Promise(function(resolve, reject) {\n        idbTransaction.oncomplete = function() {\n            resolve();\n        };\n        idbTransaction.onerror = function() {\n            reject(idbTransaction.error);\n        };\n        idbTransaction.onabort = function() {\n            reject(idbTransaction.error);\n        };\n    });\n}\n\nTransaction.prototype.objectStore = function() {\n    return new ObjectStore(this._tx.objectStore.apply(this._tx, arguments));\n};\n\nfunction UpgradeDB(db, oldVersion, transaction) {\n    this._db = db;\n    this.oldVersion = oldVersion;\n    this.transaction = new Transaction(transaction);\n}\n\nUpgradeDB.prototype.createObjectStore = function() {\n    return new ObjectStore(\n        this._db.createObjectStore.apply(this._db, arguments)\n    );\n};\n\nfunction DB(db) {\n    this._db = db;\n}\n\nDB.prototype.transaction = function() {\n    return new Transaction(this._db.transaction.apply(this._db, arguments));\n};\n\nvar exp;\n\nfunction idbIsSupported() {\n    try {\n        [\n            'IDBIndex',\n            'IDBCursor',\n            'IDBObjectStore',\n            'IDBTransaction',\n            'IDBDatabase'\n        ].forEach(function(property) {\n            if (window && (!window[property] || !window.hasOwnProperty(property))) {\n                throw new Error(property);\n            }\n        });\n        return true;\n    } catch (e) {\n        return false;\n    }\n}\n\nif (idbIsSupported()) {\n    proxyProperties(Index, '_index', [\n        'name',\n        'keyPath',\n        'multiEntry',\n        'unique'\n    ]);\n\n    proxyRequestMethods(Index, '_index', IDBIndex, [\n        'get',\n        'getKey',\n        'getAll',\n        'getAllKeys',\n        'count'\n    ]);\n\n    proxyCursorRequestMethods(Index, '_index', IDBIndex, [\n        'openCursor',\n        'openKeyCursor'\n    ]);\n\n    proxyProperties(Cursor, '_cursor', [\n        'direction',\n        'key',\n        'primaryKey',\n        'value'\n    ]);\n\n    proxyRequestMethods(Cursor, '_cursor', IDBCursor, ['update', 'delete']);\n\n    // proxy 'next' methods\n    ['advance', 'continue', 'continuePrimaryKey'].forEach(function(methodName) {\n        if (!(methodName in IDBCursor.prototype)) return;\n        Cursor.prototype[methodName] = function() {\n            var cursor = this;\n            var args = arguments;\n            return Promise.resolve().then(function() {\n                cursor._cursor[methodName].apply(cursor._cursor, args);\n                return promisifyRequest(cursor._request).then(function(value) {\n                    if (!value) return;\n                    return new Cursor(value, cursor._request);\n                });\n            });\n        };\n    });\n\n    proxyProperties(ObjectStore, '_store', [\n        'name',\n        'keyPath',\n        'indexNames',\n        'autoIncrement'\n    ]);\n\n    proxyRequestMethods(ObjectStore, '_store', IDBObjectStore, [\n        'put',\n        'add',\n        'delete',\n        'clear',\n        'get',\n        'getAll',\n        'getKey',\n        'getAllKeys',\n        'count'\n    ]);\n\n    proxyCursorRequestMethods(ObjectStore, '_store', IDBObjectStore, [\n        'openCursor',\n        'openKeyCursor'\n    ]);\n\n    proxyMethods(ObjectStore, '_store', IDBObjectStore, ['deleteIndex']);\n\n    proxyProperties(Transaction, '_tx', ['objectStoreNames', 'mode']);\n\n    proxyMethods(Transaction, '_tx', IDBTransaction, ['abort']);\n\n    proxyProperties(UpgradeDB, '_db', ['name', 'version', 'objectStoreNames']);\n\n    proxyMethods(UpgradeDB, '_db', IDBDatabase, ['deleteObjectStore', 'close']);\n\n    proxyProperties(DB, '_db', ['name', 'version', 'objectStoreNames']);\n\n    proxyMethods(DB, '_db', IDBDatabase, ['close']);\n\n    // Add cursor iterators\n    // TODO: remove this once browsers do the right thing with promises\n    ['openCursor', 'openKeyCursor'].forEach(function(funcName) {\n        [ObjectStore, Index].forEach(function(Constructor) {\n            // Don't create iterateKeyCursor if openKeyCursor doesn't exist.\n            if (!(funcName in Constructor.prototype)) return;\n\n            Constructor.prototype[\n                funcName.replace('open', 'iterate')\n            ] = function() {\n                var args = toArray(arguments);\n                var callback = args[args.length - 1];\n                var nativeObject = this._store || this._index;\n                var request = nativeObject[funcName].apply(\n                    nativeObject,\n                    args.slice(0, -1)\n                );\n                request.onsuccess = function() {\n                    callback(request.result);\n                };\n            };\n        });\n    });\n\n    // polyfill getAll\n    [Index, ObjectStore].forEach(function(Constructor) {\n        if (Constructor.prototype.getAll) return;\n        Constructor.prototype.getAll = function(query, count) {\n            var instance = this;\n            var items = [];\n\n            return new Promise(function(resolve) {\n                instance.iterateCursor(query, function(cursor) {\n                    if (!cursor) {\n                        resolve(items);\n                        return;\n                    }\n                    items.push(cursor.value);\n\n                    if (count !== undefined && items.length == count) {\n                        resolve(items);\n                        return;\n                    }\n                    cursor.continue();\n                });\n            });\n        };\n    });\n    exp = {\n        open: function(name, version, upgradeCallback) {\n            var p = promisifyRequestCall(indexedDB, 'open', [name, version]);\n            var request = p.request;\n            if (request) {\n                request.onupgradeneeded = function(event) {\n                    if (upgradeCallback) {\n                        var db = new UpgradeDB(\n                            request.result,\n                            event.oldVersion,\n                            request.transaction\n                        )\n                        db.transaction.complete.catch(function() {});\n                        upgradeCallback(db);\n                    }\n                };\n            }\n\n            return p.then(function(db) {\n                return new DB(db);\n            });\n        },\n        delete: function(name) {\n            return promisifyRequestCall(indexedDB, 'deleteDatabase', [name]);\n        }\n    };\n} else {\n    var errorMsg = 'indexedDB is not supported';\n    exp = {\n        open: function() {\n            return Promise.reject(new Error(errorMsg));\n        },\n        delete: function() {\n            return Promise.reject(new Error(errorMsg));\n        }\n    };\n}\n\nmodule.exports = exp;","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n;\nexports.ParamCheckerEnum = {\n    NonNegativeInteger: {\n        rule: isNonNegativeInteger,\n        desc: 'needs to be a non-negative integer'\n    },\n    NotNullObject: {\n        rule: function (param) {\n            return param && typeof param === 'object';\n        },\n        desc: 'needs to be a not-null object'\n    },\n    String: {\n        rule: function (param) {\n            return typeof param === 'string';\n        },\n        desc: 'needs to be a string'\n    },\n    Array: {\n        rule: function (param) {\n            return param instanceof Array;\n        },\n        desc: 'needs to be an Array'\n    },\n    Boolean: {\n        rule: function (param) {\n            return typeof param === 'boolean';\n        },\n        desc: 'needs to be a boolean'\n    }\n};\nfunction isNonNegativeInteger(x) {\n    return !isNaN(x) && x >= 0;\n}\nexports.isNonNegativeInteger = isNonNegativeInteger;\nfunction optionWithBackup(param, backup) {\n    return param !== undefined ? param : backup;\n}\nexports.optionWithBackup = optionWithBackup;\nfunction paramChecker(param, checker, paramName, optional) {\n    var exp = paramName + \" \" + checker.desc;\n    if (optional) {\n        if (param !== undefined && !checker.rule(param)) {\n            throw new Error(exp + \" if defined\");\n        }\n    }\n    else {\n        if (!checker.rule(param)) {\n            throw new Error(exp);\n        }\n    }\n}\nexports.paramChecker = paramChecker;\nfunction deduplicateList(list) {\n    var deduplicatedList = list.reduce(function (accumulator, currentItem) {\n        if (accumulator.indexOf(currentItem) < 0) {\n            return accumulator.concat(currentItem);\n        }\n        else {\n            return accumulator;\n        }\n    }, []);\n    return deduplicatedList;\n}\nexports.deduplicateList = deduplicateList;\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport { CustomDB, idbIsSupported, deleteDB } from 'idb-managed';\nimport { dateFormat2Day, M_BYTE, sizeOf, getStartOfDay, dayFormat2Date } from './utils';\nimport { ResultMsg } from '../interface';\nvar LOGAN_DB_VERSION = 1;\nvar LOGAN_DB_NAME = 'logan_web_db';\nvar LOG_DETAIL_TABLE_NAME = 'logan_detail_table';\nvar LOG_DETAIL_REPORTNAME_INDEX = 'logReportName';\nvar LOG_DETAIL_CREATETIME_INDEX = 'logCreateTime';\nvar LOG_DAY_TABLE_NAME = 'log_day_table';\nexport var LOG_DAY_TABLE_PRIMARY_KEY = 'logDay';\nvar DEFAULT_LOG_DURATION = 7 * 24 * 3600 * 1000; // logan-web keeps 7 days logs locally\nvar DEFAULT_SINGLE_DAY_MAX_SIZE = 7 * M_BYTE; // 7M storage limit for one day\nvar DEFAULT_SINGLE_PAGE_MAX_SIZE = 1 * M_BYTE; // 1M storage limit for one page\nvar LoganDB = /** @class */ (function () {\n    function LoganDB(dbName) {\n        var _a;\n        this.DB = new CustomDB({\n            dbName: dbName || LOGAN_DB_NAME,\n            dbVersion: LOGAN_DB_VERSION,\n            tables: (_a = {},\n                _a[LOG_DETAIL_TABLE_NAME] = {\n                    indexList: [\n                        {\n                            indexName: LOG_DETAIL_REPORTNAME_INDEX,\n                            unique: false\n                        },\n                        {\n                            indexName: LOG_DETAIL_CREATETIME_INDEX,\n                            unique: false\n                        }\n                    ]\n                },\n                _a[LOG_DAY_TABLE_NAME] = {\n                    primaryKey: LOG_DAY_TABLE_PRIMARY_KEY\n                },\n                _a)\n        });\n    }\n    /**\n     * @param logDay\n     * @param pageIndex start from 0\n     */\n    LoganDB.prototype.logReportNameFormatter = function (logDay, pageIndex) {\n        return logDay + \"_\" + pageIndex;\n    };\n    LoganDB.prototype.logReportNameParser = function (reportName) {\n        var splitArray = reportName.split('_');\n        return {\n            logDay: splitArray[0],\n            pageIndex: +splitArray[1]\n        };\n    };\n    LoganDB.prototype.getLogDayInfo = function (logDay) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.DB.getItem(LOG_DAY_TABLE_NAME, logDay)];\n                    case 1: return [2 /*return*/, (_a.sent())];\n                }\n            });\n        });\n    };\n    LoganDB.prototype.getLogDaysInfo = function (fromLogDay, toLogDay) {\n        return __awaiter(this, void 0, void 0, function () {\n            var result;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!(fromLogDay === toLogDay)) return [3 /*break*/, 2];\n                        return [4 /*yield*/, this.DB.getItem(LOG_DAY_TABLE_NAME, fromLogDay)];\n                    case 1:\n                        result = (_a.sent());\n                        return [2 /*return*/, result ? [result] : []];\n                    case 2: return [4 /*yield*/, this.DB.getItemsInRange({\n                            tableName: LOG_DAY_TABLE_NAME,\n                            indexRange: {\n                                indexName: LOG_DAY_TABLE_PRIMARY_KEY,\n                                lowerIndex: fromLogDay,\n                                upperIndex: toLogDay,\n                                lowerExclusive: false,\n                                upperExclusive: false\n                            }\n                        })];\n                    case 3: return [2 /*return*/, (_a.sent())];\n                }\n            });\n        });\n    };\n    LoganDB.prototype.getLogsByReportName = function (reportName) {\n        return __awaiter(this, void 0, void 0, function () {\n            var logs;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.DB.getItemsInRange({\n                            tableName: LOG_DETAIL_TABLE_NAME,\n                            indexRange: {\n                                indexName: LOG_DETAIL_REPORTNAME_INDEX,\n                                onlyIndex: reportName\n                            }\n                        })];\n                    case 1:\n                        logs = (_a.sent());\n                        return [2 /*return*/, logs];\n                }\n            });\n        });\n    };\n    LoganDB.prototype.addLog = function (logString) {\n        return __awaiter(this, void 0, void 0, function () {\n            var logSize, now, today, todayInfo, currentPageSizesArr, currentPageIndex, currentPageSize, needNewPage, nextPageSizesArr, logItem, updatedTodayInfo, durationBeforeExpired;\n            var _a, _b, _c;\n            return __generator(this, function (_d) {\n                switch (_d.label) {\n                    case 0:\n                        logSize = sizeOf(logString);\n                        now = new Date();\n                        today = dateFormat2Day(now);\n                        return [4 /*yield*/, this.getLogDayInfo(today)];\n                    case 1:\n                        todayInfo = (_d.sent()) || (_a = {},\n                            _a[LOG_DAY_TABLE_PRIMARY_KEY] = today,\n                            _a.totalSize = 0,\n                            _a.reportPagesInfo = {\n                                pageSizes: [0]\n                            },\n                            _a);\n                        if (todayInfo.totalSize + logSize > DEFAULT_SINGLE_DAY_MAX_SIZE) {\n                            throw new Error(ResultMsg.EXCEED_LOG_SIZE_LIMIT);\n                        }\n                        if (!todayInfo.reportPagesInfo || !todayInfo.reportPagesInfo.pageSizes) {\n                            todayInfo.reportPagesInfo = { pageSizes: [0] };\n                        }\n                        currentPageSizesArr = todayInfo.reportPagesInfo.pageSizes;\n                        currentPageIndex = currentPageSizesArr.length - 1;\n                        currentPageSize = currentPageSizesArr[currentPageIndex];\n                        needNewPage = currentPageSize > 0 &&\n                            currentPageSize + logSize > DEFAULT_SINGLE_PAGE_MAX_SIZE;\n                        nextPageSizesArr = (function () {\n                            var arrCopy = currentPageSizesArr.slice();\n                            if (needNewPage) {\n                                arrCopy.push(logSize);\n                            }\n                            else {\n                                arrCopy[currentPageIndex] += logSize;\n                            }\n                            return arrCopy;\n                        })();\n                        logItem = (_b = {},\n                            _b[LOG_DETAIL_REPORTNAME_INDEX] = this.logReportNameFormatter(today, needNewPage ? currentPageIndex + 1 : currentPageIndex),\n                            _b[LOG_DETAIL_CREATETIME_INDEX] = +now,\n                            _b.logSize = logSize,\n                            _b.logString = logString,\n                            _b);\n                        updatedTodayInfo = (_c = {},\n                            _c[LOG_DAY_TABLE_PRIMARY_KEY] = today,\n                            _c.totalSize = todayInfo.totalSize + logSize,\n                            _c.reportPagesInfo = {\n                                pageSizes: nextPageSizesArr\n                            },\n                            _c);\n                        durationBeforeExpired = DEFAULT_LOG_DURATION - (+new Date() - getStartOfDay(new Date()));\n                        return [4 /*yield*/, this.DB.addItems([\n                                {\n                                    tableName: LOG_DAY_TABLE_NAME,\n                                    item: updatedTodayInfo,\n                                    itemDuration: durationBeforeExpired\n                                },\n                                {\n                                    tableName: LOG_DETAIL_TABLE_NAME,\n                                    item: logItem,\n                                    itemDuration: durationBeforeExpired\n                                }\n                            ])];\n                    case 2:\n                        _d.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /**\n     * Delete reported pages of logDay, in case that new pages are added after last report.\n     */\n    LoganDB.prototype.incrementalDelete = function (logDay, reportedPageIndexes) {\n        return __awaiter(this, void 0, void 0, function () {\n            var dayInfo, currentPageSizesArr_1, currentTotalSize, totalReportedSize, pageSizesArrayWithNewPage, resetReportedPageSizes, updatedDayInfo, durationBeforeExpired, _i, reportedPageIndexes_1, pageIndex;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.getLogDayInfo(logDay)];\n                    case 1:\n                        dayInfo = _a.sent();\n                        if (!(dayInfo && dayInfo.reportPagesInfo && dayInfo.reportPagesInfo.pageSizes instanceof Array)) return [3 /*break*/, 6];\n                        currentPageSizesArr_1 = dayInfo.reportPagesInfo.pageSizes;\n                        currentTotalSize = dayInfo.totalSize;\n                        totalReportedSize = currentPageSizesArr_1.reduce(function (accSize, currentSize, indexOfPage) {\n                            if (reportedPageIndexes.indexOf(indexOfPage) >= 0) {\n                                return accSize + currentSize;\n                            }\n                            else {\n                                return accSize;\n                            }\n                        }, 0);\n                        pageSizesArrayWithNewPage = (function addNewPageIfLastPageIsReported() {\n                            // Add a new page with 0 page size if the last page is reported.\n                            if (reportedPageIndexes.indexOf(currentPageSizesArr_1.length - 1) >= 0) {\n                                return currentPageSizesArr_1.concat([0]);\n                            }\n                            else {\n                                return currentPageSizesArr_1;\n                            }\n                        })();\n                        resetReportedPageSizes = pageSizesArrayWithNewPage.reduce(function (accSizesArray, currentSize, index) {\n                            if (reportedPageIndexes.indexOf(index) >= 0) {\n                                return accSizesArray.concat([0]); // Reset to 0 if this page is reported.\n                            }\n                            else {\n                                return accSizesArray.concat([currentSize]);\n                            }\n                        }, []);\n                        updatedDayInfo = __assign(__assign({}, dayInfo), { reportPagesInfo: {\n                                pageSizes: resetReportedPageSizes\n                            }, totalSize: Math.max(currentTotalSize - totalReportedSize, 0) });\n                        durationBeforeExpired = DEFAULT_LOG_DURATION - (+new Date() - getStartOfDay(new Date())) - (getStartOfDay(new Date()) - dayFormat2Date(logDay).getTime());\n                        return [4 /*yield*/, this.DB.addItems([\n                                {\n                                    tableName: LOG_DAY_TABLE_NAME,\n                                    item: updatedDayInfo,\n                                    itemDuration: durationBeforeExpired\n                                }\n                            ])];\n                    case 2:\n                        _a.sent();\n                        _i = 0, reportedPageIndexes_1 = reportedPageIndexes;\n                        _a.label = 3;\n                    case 3:\n                        if (!(_i < reportedPageIndexes_1.length)) return [3 /*break*/, 6];\n                        pageIndex = reportedPageIndexes_1[_i];\n                        return [4 /*yield*/, this.DB.deleteItemsInRange([\n                                {\n                                    tableName: LOG_DETAIL_TABLE_NAME,\n                                    indexRange: {\n                                        indexName: LOG_DETAIL_REPORTNAME_INDEX,\n                                        onlyIndex: this.logReportNameFormatter(logDay, pageIndex)\n                                    }\n                                }\n                            ])];\n                    case 4:\n                        _a.sent();\n                        _a.label = 5;\n                    case 5:\n                        _i++;\n                        return [3 /*break*/, 3];\n                    case 6: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    LoganDB.idbIsSupported = idbIsSupported;\n    LoganDB.deleteDB = deleteDB;\n    return LoganDB;\n}());\nexport default LoganDB;\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\n/**\n * @file This file is to arrange logan operations in queue, in order to avoid parallel async writing operations on db which may cause race condition problems.\n *\n * LoganlogLoganDBreportDBLogan\n *\n */\nvar loganOperationQueue = [];\nvar operationRunning = false;\nfunction loganOperationsRecursion() {\n    return __awaiter(this, void 0, void 0, function () {\n        var nextOperation, result, e_1;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    if (!(loganOperationQueue.length > 0 && !operationRunning)) return [3 /*break*/, 5];\n                    nextOperation = loganOperationQueue.shift();\n                    operationRunning = true;\n                    _a.label = 1;\n                case 1:\n                    _a.trys.push([1, 3, , 4]);\n                    return [4 /*yield*/, nextOperation.asyncF()];\n                case 2:\n                    result = _a.sent();\n                    nextOperation.resolution(result);\n                    return [3 /*break*/, 4];\n                case 3:\n                    e_1 = _a.sent();\n                    nextOperation.rejection(e_1);\n                    return [3 /*break*/, 4];\n                case 4:\n                    operationRunning = false; /* eslint-disable-line */ // No need to worry require-atomic-updates here.\n                    loganOperationsRecursion();\n                    return [3 /*break*/, 0];\n                case 5: return [2 /*return*/];\n            }\n        });\n    });\n}\nexport function invokeInQueue(asyncF) {\n    return new Promise(function (resolve, reject) {\n        loganOperationQueue.push({\n            asyncF: asyncF,\n            resolution: resolve,\n            rejection: reject\n        });\n        loganOperationsRecursion();\n    });\n}\n"],"names":["__assign","this","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","__generator","body","f","y","g","_","label","sent","trys","ops","verb","Symbol","iterator","v","op","TypeError","pop","push","defineProperty","exports","utils_1","require","IDB","IDB_MANAGER_VERSION","IDB_MANAGER_DB_NAME","IDB_MANAGER_DB_TABLE_NAME","IDB_MANAGER_DB_TABLE_INDEX_NAME","UPDATETIME_KEYNAME","EXPIRETIME_KEYNAME","indexRange2DBKey","indexRange","onlyIndex","lowerIndex","upperIndex","_a","lowerExclusive","_b","upperExclusive","undefined","IDBKeyRange","only","bound","lowerBound","upperBound","itemWrapper","itemConfig","currentTime","Date","now","item","itemDuration","itemUnwrapper","expireTime","updateTime","registerDBInManager","dbInfo","dbManager","dbAlreadyInManager","addDBTrans","table","dbItem","openDBManager","getItemFromDB","name","version","transaction","objectStore","dbName","tableList","put","tableName","complete","close","unregisterDBInManager","deleteTrans","delete","createDB","db","open","upgradeDB","upgradeDBWithTableList","upgradeDBManager","openDB","primaryKeyValue","trans","itemInTable","objectStoreNames","contains","get","createObjectStore","keyPath","forEach","tableConfig","currentTable_1","indexList","theIndex","indexNames","indexName","createIndex","unique","tablePrimaryKey","primaryKey","tableToCreate_1","autoIncrement","atomicTrans","tryStatement","transError_1","abort","deleteItemsFromDB","tableIndexRanges","validRanges","dedupTableNameList","deleteItemsTrans","_this","filter","deduplicateList","map","tableIndexRange","all","index","iterateCursor","cursor","continue","clear","addItems","items","addItemsTrans","deleteItems","getItem","e_3","getItemsInRange","items_1","table_1","wrappedItems","e_5","getAll","deleteDB","db_env_checker_1","db_wrapper_1","DEFAULT_DB_VERSION","OPTIONAL","customDBConfigChecker","dbConfig","paramChecker","ParamCheckerEnum","NotNullObject","String","dbVersion","NonNegativeInteger","tables","keys","Array","Boolean","customDBAddItemsParamChecker","tableListInDB","itemOfTable","theTable","Error","getOwnPropertyNames","indexOf","tableIndexRangeParamChecker","idbIsSupported","default","CustomDB","optionWithBackup","itemConfigs","itemDurationOverrider","itemsWithDuration","ofDB","ofTable","ofItem","getItemsInRangeFromDB","deleteItemsInRange","default_1","window","_i","property","toArray","arr","slice","promisifyRequest","request","onsuccess","onerror","error","promisifyRequestCall","obj","method","args","promisifyCursorRequestCall","Cursor","proxyProperties","ProxyClass","targetProp","properties","prop","set","val","proxyRequestMethods","Constructor","proxyMethods","proxyCursorRequestMethods","Index","_index","_cursor","_request","ObjectStore","store","_store","Transaction","idbTransaction","_tx","oncomplete","onabort","UpgradeDB","oldVersion","_db","DB","exp","IDBIndex","IDBCursor","methodName","IDBObjectStore","IDBTransaction","IDBDatabase","funcName","replace","callback","nativeObject","query","count","instance","upgradeCallback","indexedDB","onupgradeneeded","event","catch","errorMsg","module","isNonNegativeInteger","x","isNaN","param","backup","checker","paramName","optional","desc","rule","list","deduplicatedList","reduce","accumulator","currentItem","concat","LOGAN_DB_VERSION","LOGAN_DB_NAME","LOG_DETAIL_TABLE_NAME","LOG_DETAIL_REPORTNAME_INDEX","LOG_DETAIL_CREATETIME_INDEX","LOG_DAY_TABLE_NAME","LOG_DAY_TABLE_PRIMARY_KEY","DEFAULT_LOG_DURATION","DEFAULT_SINGLE_DAY_MAX_SIZE","M_BYTE","DEFAULT_SINGLE_PAGE_MAX_SIZE","LoganDB","logReportNameFormatter","logDay","pageIndex","logReportNameParser","reportName","splitArray","split","getLogDayInfo","getLogDaysInfo","fromLogDay","toLogDay","getLogsByReportName","logs","addLog","logString","logSize","today","todayInfo","currentPageSizesArr","currentPageIndex","currentPageSize","needNewPage","nextPageSizesArr","logItem","updatedTodayInfo","durationBeforeExpired","_c","_d","sizeOf","dateFormat2Day","totalSize","reportPagesInfo","pageSizes","ResultMsg","arrCopy","getStartOfDay","incrementalDelete","reportedPageIndexes","dayInfo","currentPageSizesArr_1","currentTotalSize","totalReportedSize","pageSizesArrayWithNewPage","resetReportedPageSizes","updatedDayInfo","reportedPageIndexes_1","accSize","currentSize","indexOfPage","accSizesArray","Math","max","dayFormat2Date","getTime","loganOperationQueue","operationRunning","loganOperationsRecursion","nextOperation","e_1","shift","asyncF","resolution","rejection","invokeInQueue"],"sourceRoot":""}